grant:
  description: grant access to user(s) at specified host(s)
  main:
    --to-user:
      short: -u
      action: append
      dest: uid
      nargs: '+'
      metavar: <user name>
    --on-host:
      short: -H
      action: append
      dest: services
      nargs: '+'
      metavar: <host name>
    --on-cluster:
      short: -c
      action: append
      dest: services
      nargs: '+'
      metavar: <cluster name>
    --on-service:
      short: -s
      action: append
      dest: services
      nargs: '+'
      metavar: <service short name>
    --privileged:
      short: -P
      dest: privileged
      action: store_true
      help: make the access privileged

deny:
  description: deny access to user(s) at specified host(s)
  main:
    --to-user:
      short: -u
      action: append
      dest: uid
      nargs: '+'
      metavar: <user name>
    --on-host:
      short: -H
      action: append
      dest: services
      nargs: '+'
      metavar: <host name>
    --on-cluster:
      short: -c
      action: append
      dest: services
      nargs: '+'
      metavar: <cluster name>
    --on-service:
      short: -s
      action: append
      dest: services
      nargs: '+'
      metavar: <service short name>

revoke:
  description: revoke access grant or denial
  main:
    --revoke-type:
      short: -t
      action: append
      choices:
      - granted
      - denied
      - privileged
      dest: revoke_levels 
      metavar: <access level>
    --from-user:
      short: -u
      action: append
      dest: uid
      nargs: '+'
      metavar: <user name>
    --on-host:
      short: -H
      action: append
      dest: services
      nargs: '+'
      metavar: <host name>
    --on-cluster:
      short: -c
      action: append
      dest: services
      nargs: '+'
      metavar: <cluster name>
    --on-service:
      short: -s
      action: append
      dest: services
      nargs: '+'
      metavar: <service name>

show:
  description: show access details for user(s) or host(s)
  main:
    --type:
      short: -t
      action: store
      choices:
      - user
      - host
      - service
      - cluster
      dest: query_type
    query:
      nargs: '+'
      help: <hosts, users or services>
